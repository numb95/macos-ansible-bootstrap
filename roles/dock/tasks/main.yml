---
- name: Set Dock autohide
  ansible.builtin.command: defaults write com.apple.dock autohide -bool {{ dock_autohide | bool }}
  tags:
    - dock

- name: Set Dock tile size
  ansible.builtin.command: defaults write com.apple.dock tilesize -int {{ dock_tilesize }}
  tags:
    - dock

- name: Set Dock magnification
  ansible.builtin.command: defaults write com.apple.dock magnification -bool {{ dock_magnification | bool }}
  tags:
    - dock

- name: Set Dock magnification size
  ansible.builtin.command: defaults write com.apple.dock largesize -int {{ dock_largesize }}
  tags:
    - dock

- name: Set Dock position
  ansible.builtin.command: defaults write com.apple.dock orientation -string {{ dock_orientation }}
  tags:
    - dock

- name: Set Dock show recent apps
  ansible.builtin.command: defaults write com.apple.dock show-recents -bool {{ dock_show_recents | bool }}
  when: dock_show_recents is not none
  tags:
    - dock

- name: Set hot corner top left
  ansible.builtin.command: defaults write com.apple.dock wvous-tl-corner -int {{ hotcorner_top_left }}
  tags:
    - dock

- name: Set hot corner top left modifier
  ansible.builtin.command: defaults write com.apple.dock wvous-tl-modifier -int {{ hotcorner_top_left_modifier }}
  tags:
    - dock

- name: Set hot corner top right
  ansible.builtin.command: defaults write com.apple.dock wvous-tr-corner -int {{ hotcorner_top_right }}
  tags:
    - dock

- name: Set hot corner top right modifier
  ansible.builtin.command: defaults write com.apple.dock wvous-tr-modifier -int {{ hotcorner_top_right_modifier }}
  tags:
    - dock

- name: Set hot corner bottom left
  ansible.builtin.command: defaults write com.apple.dock wvous-bl-corner -int {{ hotcorner_bottom_left }}
  tags:
    - dock

- name: Set hot corner bottom left modifier
  ansible.builtin.command: defaults write com.apple.dock wvous-bl-modifier -int {{ hotcorner_bottom_left_modifier }}
  tags:
    - dock

- name: Set hot corner bottom right
  ansible.builtin.command: defaults write com.apple.dock wvous-br-corner -int {{ hotcorner_bottom_right }}
  tags:
    - dock

- name: Set hot corner bottom right modifier
  ansible.builtin.command: defaults write com.apple.dock wvous-br-modifier -int {{ hotcorner_bottom_right_modifier }}
  tags:
    - dock

- name: Write Dock apps list to temp file
  ansible.builtin.copy:
    dest: /tmp/dock_apps.json
    content: "{{ dock_persistent_apps | to_json }}"
    mode: "0600"
  tags:
    - dock

- name: Apply Dock pinned apps
  ansible.builtin.command: python3 {{ playbook_dir }}/../scripts/apply_dock_apps.py /tmp/dock_apps.json
  when: dock_persistent_apps | length > 0
  tags:
    - dock

- name: Restart Dock
  ansible.builtin.command: killall Dock
  changed_when: true
  tags:
    - dock
