---
- name: Set Dock autohide
  community.general.osx_defaults:
    domain: com.apple.dock
    key: autohide
    type: bool
    value: "{{ dock_autohide | bool }}"
  tags:
    - dock

- name: Set Dock tile size
  community.general.osx_defaults:
    domain: com.apple.dock
    key: tilesize
    type: int
    value: "{{ dock_tilesize }}"
  tags:
    - dock

- name: Set Dock magnification
  community.general.osx_defaults:
    domain: com.apple.dock
    key: magnification
    type: bool
    value: "{{ dock_magnification | bool }}"
  tags:
    - dock

- name: Set Dock magnification size
  community.general.osx_defaults:
    domain: com.apple.dock
    key: largesize
    type: int
    value: "{{ dock_largesize }}"
  tags:
    - dock

- name: Set Dock position
  community.general.osx_defaults:
    domain: com.apple.dock
    key: orientation
    type: string
    value: "{{ dock_orientation }}"
  tags:
    - dock

- name: Set Dock show recent apps
  community.general.osx_defaults:
    domain: com.apple.dock
    key: show-recents
    type: bool
    value: "{{ dock_show_recents | bool }}"
  when: dock_show_recents is not none
  tags:
    - dock

- name: Set hot corner top left
  community.general.osx_defaults:
    domain: com.apple.dock
    key: wvous-tl-corner
    type: int
    value: "{{ hotcorner_top_left }}"
  tags:
    - dock

- name: Set hot corner top left modifier
  community.general.osx_defaults:
    domain: com.apple.dock
    key: wvous-tl-modifier
    type: int
    value: "{{ hotcorner_top_left_modifier }}"
  tags:
    - dock

- name: Set hot corner top right
  community.general.osx_defaults:
    domain: com.apple.dock
    key: wvous-tr-corner
    type: int
    value: "{{ hotcorner_top_right }}"
  tags:
    - dock

- name: Set hot corner top right modifier
  community.general.osx_defaults:
    domain: com.apple.dock
    key: wvous-tr-modifier
    type: int
    value: "{{ hotcorner_top_right_modifier }}"
  tags:
    - dock

- name: Set hot corner bottom left
  community.general.osx_defaults:
    domain: com.apple.dock
    key: wvous-bl-corner
    type: int
    value: "{{ hotcorner_bottom_left }}"
  tags:
    - dock

- name: Set hot corner bottom left modifier
  community.general.osx_defaults:
    domain: com.apple.dock
    key: wvous-bl-modifier
    type: int
    value: "{{ hotcorner_bottom_left_modifier }}"
  tags:
    - dock

- name: Set hot corner bottom right
  community.general.osx_defaults:
    domain: com.apple.dock
    key: wvous-br-corner
    type: int
    value: "{{ hotcorner_bottom_right }}"
  tags:
    - dock

- name: Set hot corner bottom right modifier
  community.general.osx_defaults:
    domain: com.apple.dock
    key: wvous-br-modifier
    type: int
    value: "{{ hotcorner_bottom_right_modifier }}"
  tags:
    - dock

- name: Write Dock apps list to temp file
  ansible.builtin.copy:
    dest: /tmp/dock_apps.json
    content: "{{ dock_persistent_apps | to_json }}"
    mode: "0600"
  tags:
    - dock

- name: Apply Dock pinned apps
  ansible.builtin.command: python3 {{ playbook_dir }}/../scripts/apply_dock_apps.py /tmp/dock_apps.json
  when: dock_persistent_apps | length > 0
  changed_when: false
  tags:
    - dock

- name: Restart Dock
  ansible.builtin.command: killall Dock
  changed_when: true
  tags:
    - dock
